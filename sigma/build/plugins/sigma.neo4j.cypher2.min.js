(function(a){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.neo4j"),sigma.utils.pkg("sigma.utils"),sigma.neo4j.send=function(a,b,c,d,e){var f,g=sigma.utils.xhr();if(f=a,"object"==typeof a&&(f=a.url,a.user,a.password),!g)throw"XMLHttpRequest not supported, cannot load the file.";f+=b,g.open(c,f,!0),g.setRequestHeader("Accept","application/json"),g.setRequestHeader("Content-type","application/json; charset=utf-8"),g.onreadystatechange=function(){4===g.readyState&&e(JSON.parse(g.responseText))},g.send(d)},sigma.neo4j.cypher_parse=function(a,b){var c,d={nodes:[],edges:[]},e={},f={};a.nodes&&a.nodes.forEach(function(a){var c=b.node(a);c.id in e||(e[c.id]=c)}),a.relationships&&a.relationships.forEach(function(a){var c=b.edge(a);c.id in f||(f[c.id]=c)});for(c in e)d.nodes.push(e[c]);for(c in f)d.edges.push(f[c]);return d},sigma.neo4j.cypher2=function(a,b,c,d,e){var f,g,h="/v1/graph";e||(e=sigma.neo4j.defaultProducers),f=JSON.stringify({wikiName:b}),g=function(a){return function(b){var d={nodes:[],edges:[]};d=sigma.neo4j.cypher_parse(b,e);var f=c.graph.nodes().map(function(a){return a.id}),g=c.graph.edges().map(function(a){return a.id}),h=performance.now();d.nodes.map(function(a){f.includes(a.id)||c.graph.addNode(a)}),d.edges.map(function(a){g.includes(a.id)||c.graph.addEdge(a)});var i=performance.now();console.log("Call to doSomething2 took "+(i-h)+" milliseconds."),c.refresh();var j=performance.now();console.log("Call to doSomething3 took "+(j-i)+" milliseconds."),a&&a(c||d)}},sigma.neo4j.send(a,h,"POST",f,g(d))},sigma.neo4j.getLabels=function(a,b){sigma.neo4j.send(a,"/db/data/labels","GET",null,b)},sigma.neo4j.getTypes=function(a,b){sigma.neo4j.send(a,"/db/data/relationship/types","GET",null,b)},sigma.neo4j.defaultProducers={node:function(a){return{id:a.id,label:a.id,x:Math.random(),y:Math.random(),size:1,color:"#666666",neo4j_labels:a.labels,neo4j_data:a.properties}},edge:function(a){return{id:a.id,label:a.type,source:a.startNode,target:a.endNode,color:"#7D7C8E",neo4j_type:a.type,neo4j_data:a.properties}}}}).call(window);